{% extends 'base-admin.html' %}
{% block title %}Chi tiết khóa học{% endblock %}

{% block content %}
<style>
/* -- CSS giữ nguyên như bạn đã viết ở trên -- */
.course-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 20px;

  position: sticky;
  top: 0;
  background-color: white;
  z-index: 999;
  border-bottom: 1px solid #ddd;
}
.course-info h1 {
  font-size: 22px;
  font-weight: 600;
  margin-right: 10px;
}
.course-date {
  margin-left: 10px;
  font-size: 14px;
  color: #777;
}
.action-buttons .btn {
  margin-left: 10px;
}
.btn {
  padding: 8px 14px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}
.delete-btn {
  background-color: #dc3545;
  color: #fff;
}
.delete-btn:hover {
  background-color: #c82333;
}
.save-btn {
  background-color: #28a745;
  color: #fff;
}
.save-btn:hover {
  background-color: #218838;
}
.tab-nav {
  border-bottom: 1px solid #ddd;
  margin-bottom: 20px;
}
.tab {
  background: none;
  border: none;
  padding: 10px 20px;
  cursor: pointer;
  font-size: 14px;
  color: #555;
  outline: none;
}
.tab.active {
  border-bottom: 2px solid #007bff;
  color: #007bff;
}
.course-overview {
  display: grid;
  column-gap: 20px;
  row-gap: 16px;
  margin-bottom: 30px;
}
.form-group {
  display: flex;
  flex-direction: column;
}
.form-group label {
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 5px;
}
.form-group input,
.form-group textarea {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
}
#courseDescription {
  grid-column: 1 / 3;
}
.sessions-section h2 {
  margin-bottom: 10px;
  font-size: 18px;
  font-weight: 600;
}
.sessions-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
}
.wrapper_table {
  max-height: 210px;
  overflow-y: auto;
  margin-bottom: 20px;
}
.sessions-table thead {
  background: #f1f1f1;
}
.sessions-table thead th {
  position: sticky;
  top: 0;
  background-color: #f1f1f1;
  z-index: 2;
}
.sessions-table th,
.sessions-table td {
  padding: 10px;
  border: 1px solid #ddd;
  text-align: left;
  font-size: 14px;
}
.status {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
}
.status.done {
  background-color: #d4edda;
  color: #155724;
}
.status.pending {
  background-color: #fff3cd;
  color: #856404;
}
.add-session-btn {
  background-color: #007bff;
  color: #fff;
}
.add-session-btn:hover {
  background-color: #0056b3;
}
</style>

<div class="course-detail-container">
  <!-- Header -->
  <div class="course-header">
    <div class="course-info" style="display: flex; align-items: center; gap: 12px; ">
      <button onclick="history.back()" class="btn back-btn" style="
          font-size: 20px;
          font-weight: 600;
          cursor: pointer;
          margin-bottom: 10px;
        ">
        ←
      </button>
      <h1>{{ course.course_name }}</h1>
      <span class="course-date">{{ course.begin_date|default:"" }}</span>
    </div>
    <div class="action-buttons">
      <button class="btn delete-btn">Xóa</button>
      <button class="btn save-btn">Lưu</button>
    </div>
  </div>

  <!-- Tab -->
  <div class="tab-nav">
    <button class="tab active">Tổng quan</button>
  </div>

  <!-- Thông tin tổng quan -->
  <div class="course-overview">
    <div class="form-group">
      <label for="courseName">Tên khóa học</label>
      <input type="text" id="courseName" value="{{ course.course_name }}">
    </div>

    <div class="form-group">
      <label for="courseDescription">Mô tả</label>
      <textarea id="courseDescription" rows="4">{{ course.description }}</textarea>
    </div>

    <div class="form-group">
      <label for="instructor">Giáo viên</label>
      <select id="instructor" name="instructor">
        {% for teacher in teachers %}
          <option value="{{ teacher.username }}"
            {% if teacher.username == course.teacher_name %}selected{% endif %}>
            {{ teacher.username }}
          </option>
        {% endfor %}
      </select>
    </div>


    <div class="form-group">
      <label for="duration">Thời gian</label>
      <input type="text" id="duration" value="3 tháng">
    </div>

    <div class="form-group">
      <label for="price">Giá</label>
      <input type="text" id="price" value="{{ course.price }} VND">
    </div>
  </div>

  <!-- Danh sách buổi học -->
  <div class="sessions-section">
    <h2>Các buổi học</h2>
    <div class="wrapper_table">
      <table class="sessions-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Tuần</th>
            <th>Chủ đề</th>
            <th>Mô tả</th>
            <th>Ngày học</th>
            <th>Trạng thái</th>
          </tr>
        </thead>
        <tbody>
          {% for ld in lesson_details %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>Tuần {{ forloop.counter }}</td>
            <td>{{ ld.lesson.lesson_name }}</td>
            <td>{{ ld.lesson.description|default:"Không có" }}</td>
            <td>{{ ld.class_instance.begin_time|date:"d/m/Y" }}</td>
            <td>
              <span class="status {% if forloop.counter0 < 2 %}done{% else %}pending{% endif %}">
                {% if forloop.counter0 < 2 %}Xong{% else %}Chưa học{% endif %}
              </span>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6">Chưa có buổi học nào.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Nút thêm -->
    <a href="{% url 'add_lesson_detail' course.course_id %}">
      <button class="btn add-session-btn">Thêm buổi học</button>
    </a>
  </div>
</div>
{% endblock %}
