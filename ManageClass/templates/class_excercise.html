{% extends "base-admin.html" %}
{% block title %}Bài tập - Lớp {{ classroom.class_name }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h4>Danh sách lớp học > Lớp {{ classroom.class_name }}</h4>


    <ul class="nav nav-tabs mb-3 mt-3" id="classTab" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link" href="{% url 'class_detail' class_id=cls.class_id %}">Mô tả lớp học</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link active" href="#">Bài tập</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" href="{% url 'class_rollcall' class_id=cls.class_id %}">Điểm danh</a>
        </li>
    </ul>


    <div class="row mb-3">
        <div class="col-md-4">
            <input type="text" class="form-control" placeholder="Search exercise">
        </div>
        <div class="col-md-3">
            <select class="form-select">
                <option selected>Chọn bài tập</option>
                {% for lesson in lessons %}
                <option value="{{ lesson.id }}">Buổi {{ lesson.session_number }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-3">
            <select class="form-select">
                <option selected>Chọn trạng thái</option>
                <option value="graded">Đã chấm</option>
                <option value="submitted">Đã nộp</option>
                <option value="not_submitted">Chưa nộp</option>
            </select>
        </div>
    </div>

    <!-- Bảng dữ liệu -->
    <div class="table-responsive">
        <table class="table table-bordered align-middle table-hover">
            <thead class="table-light text-center">
                <tr>
                    <th>ID</th>
                    <th>Họ và tên</th>
                    <th>Bài tập</th>
                    <th>Trạng thái</th>
                    <th>Ngày nộp</th>
                </tr>
            </thead>
            <tbody class="text-center">
                {% for submission in submissions %}
                <tr>
                    <td>{{ submission.user_profile.student_id }}</td>
                    <td>{{ submission.user_profile.user.get_full_name }}</td>
                    <td>Buổi {{ submission.exercise.lesson.lesson_detail.session_number }}</td>
                    <td>
                        {% if submission.graded %}
                            <span class="badge bg-success">Đã chấm</span>
                        {% elif submission.submitted_at %}
                            <span class="badge bg-warning text-dark">Đã nộp</span>
                        {% else %}
                            <span class="badge bg-secondary">Chưa nộp</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if submission.submitted_at %}
                            {{ submission.submitted_at|date:"d M Y g:i a" }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">Chưa có bài nộp nào trong lớp này.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
